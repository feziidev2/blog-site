<h1><%= blog.title %></h1>
<% if (blog.image) { %>
  <img src="/<%= blog.image %>" alt="<%= blog.title %>" class="img-fluid mb-3">
<% } %>
<p><strong>Author:</strong> <%= blog.author.username %></p>
<p><%= blog.content %></p>
<div>
  <form action="/blogs/like/<%= blog._id %>" method="POST" style="display:inline;">
    <button type="submit" class="btn btn-success">Like (<%= blog.likes.length %>)</button>
  </form>
  <form action="/blogs/dislike/<%= blog._id %>" method="POST" style="display:inline;">
    <button type="submit" class="btn btn-danger">Dislike (<%= blog.dislikes.length %>)</button>
  </form>
</div>
<% if (user && (user.role === 'author' && user.id === blog.author._id.toString() || user.role === 'admin')) { %>
  <a href="/blogs/edit/<%= blog._id %>" class="btn btn-warning mt-3">Edit</a>
  <form action="/blogs/delete/<%= blog._id %>" method="POST" style="display:inline;">
    <button type="submit" class="btn btn-danger mt-3">Delete</button>
  </form>
<% } %>

<h3>Comments</h3>
<% blog.comments.forEach(comment => { %>
  <div class="card mb-2">
    <div class="card-body">
      <p><strong><%= comment.user.username %>:</strong> <%= comment.content %></p>
      <small><%= comment.createdAt.toDateString() %></small>
    </div>
  </div>
<% }) %>

<% if (user) { %>
  <form action="/comments/create/<%= blog._id %>" method="POST" class="mt-3">
    <div class="mb-3">
      <label for="content" class="form-label">Add Comment</label>
      <textarea class="form-control" id="content" name="content" required></textarea>
    </div>
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
<% } %>